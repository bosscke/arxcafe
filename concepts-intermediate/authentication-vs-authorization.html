<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication vs Authorization</title>
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/concepts.css">
</head>
<body class="authentication-vs-authorization-page">
    <a href="/" class="home-btn">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 18px; height: 18px;">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
        </svg>
        Home
    </a>

    <div class="container">
        <h1>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 40px; height: 40px; display: inline-block; margin-right: 10px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5zm0 9.75c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5zm9.75-9.75c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5zm0 9.75c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5z"/></svg>
            Authentication vs Authorization
        </h1>

        <div class="intro-box">
            <p><strong>Authentication (AuthN)</strong> verifies <em>who you are</em>, while <strong>Authorization (AuthZ)</strong> determines <em>what you can do</em>. These complementary security mechanisms work together: first you prove your identity, then the system checks your permissions. Understanding the distinction is essential for building secure applications.</p>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M6 12h12M6 6h12M6 18h12"/></svg>
            Key Differences
        </h2>

        <div class="architecture-grid">
            <div class="arch-card">
                <h3>Authentication</h3>
                <ul class="features-list">
                    <li><strong>Question:</strong> "Who are you?"</li>
                    <li><strong>Purpose:</strong> Verify identity</li>
                    <li><strong>Methods:</strong> Password, MFA, biometrics, SSO</li>
                    <li><strong>Result:</strong> Authenticated session/token</li>
                </ul>
            </div>
            <div class="arch-card">
                <h3>Authorization</h3>
                <ul class="features-list">
                    <li><strong>Question:</strong> "What can you access?"</li>
                    <li><strong>Purpose:</strong> Grant/deny permissions</li>
                    <li><strong>Methods:</strong> RBAC, ABAC, ACLs, policies</li>
                    <li><strong>Result:</strong> Allow/deny resource access</li>
                </ul>
            </div>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v18m0-18c-1.5 1.5-4.5 4.5-7.5 4.5S1.5 4.5 0 3m12 0c1.5 1.5 4.5 4.5 7.5 4.5S22.5 4.5 24 3"/></svg>
            Real-World Analogy
        </h2>

        <div class="flow-diagram">
            <div style="font-weight: bold; margin-bottom: 16px; color: #667eea;">Airport Security Example:</div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 12px;">
                <div class="flow-step" style="border-left-color: #667eea;">
                    <strong>Authentication:</strong> TSA checks your ID and boarding pass to verify you are who you claim to be.
                </div>
                <div class="flow-step" style="border-left-color: #13AA52;">
                    <strong>Authorization:</strong> Your ticket grants access to specific gate, seat, and airline lounge (based on ticket class).
                </div>
            </div>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 7.5h10.5m-10.5 3h10.5m-10.5 3h10.5m-10.5 3h5.25"/></svg>
            Authentication Methods
        </h2>

        <div class="architecture-grid">
            <div class="arch-card">
                <h3>Password-Based</h3>
                <p>Username + password; most common but weakest alone. Use strong hashing (bcrypt, Argon2) and enforce complexity.</p>
            </div>
            <div class="arch-card">
                <h3>Multi-Factor (MFA/2FA)</h3>
                <p>Something you know + something you have (OTP, SMS, app) + something you are (biometric). Significantly more secure.</p>
            </div>
            <div class="arch-card">
                <h3>Token-Based (JWT, OAuth)</h3>
                <p>Stateless tokens issued after login; passed in headers. Scalable for APIs and microservices.</p>
            </div>
            <div class="arch-card">
                <h3>Biometric</h3>
                <p>Fingerprint, face recognition, iris scan. Convenient but requires special hardware; hard to revoke if compromised.</p>
            </div>
            <div class="arch-card">
                <h3>Certificate-Based (mTLS)</h3>
                <p>Client presents X.509 certificate. Common for service-to-service auth in zero-trust environments.</p>
            </div>
            <div class="arch-card">
                <h3>Single Sign-On (SSO)</h3>
                <p>Authenticate once, access multiple apps (SAML, OAuth, OpenID Connect). Centralized identity provider.</p>
            </div>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="m6.75 7.5 4.5 9 4.5-9m-9 0 4.5-4.5 4.5 4.5m-9 0h9m-9 0L3 12l3.75-4.5m9 0L21 12l-3.75-4.5"/></svg>
            Authorization Models
        </h2>

        <div class="architecture-grid">
            <div class="arch-card">
                <h3>RBAC (Role-Based)</h3>
                <p>Assign users to roles (admin, editor, viewer); roles have permissions. Simple, widely used.</p>
            </div>
            <div class="arch-card">
                <h3>ABAC (Attribute-Based)</h3>
                <p>Decisions based on attributes (user, resource, environment). More flexible but complex.</p>
            </div>
            <div class="arch-card">
                <h3>ACL (Access Control List)</h3>
                <p>Per-resource permissions list. Common in filesystems, databases. Can become unwieldy at scale.</p>
            </div>
            <div class="arch-card">
                <h3>Policy-Based (PBAC)</h3>
                <p>Centralized policy engine (e.g., OPA, AWS IAM). Declarative rules; decouples logic from code.</p>
            </div>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 19.5a9 9 0 1 1 15 0"/></svg>
            Typical Flow
        </h2>

        <div class="flow-diagram">
            <div style="font-weight: bold; margin-bottom: 16px; color: #667eea;">Request Lifecycle:</div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px;">
                <div class="flow-step" style="border-left-color: #667eea;">1) User submits credentials</div>
                <div class="flow-step" style="border-left-color: #13AA52;">2) System authenticates identity</div>
                <div class="flow-step" style="border-left-color: #FFA500;">3) Session/token issued</div>
                <div class="flow-step" style="border-left-color: #DD0031;">4) User requests resource</div>
                <div class="flow-step" style="border-left-color: #14B8A6;">5) System checks authorization</div>
                <div class="flow-step" style="border-left-color: #8B5CF6;">6) Grant or deny access</div>
            </div>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 3h3m-6 3h6M6.75 6h10.5a2.25 2.25 0 0 1 2.25 2.25v9A2.25 2.25 0 0 1 17.25 19.5H6.75A2.25 2.25 0 0 1 4.5 17.25v-9A2.25 2.25 0 0 1 6.75 6z"/></svg>
            Code Examples
        </h2>

        <div style="background: rgba(102, 126, 234, 0.1); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 25px; margin: 30px 0; display: grid; gap: 18px;">
            <div>
                <h3>JWT Authentication (Node.js)</h3>
                <div style="background: #1e1e1e; color: #d4d4d4; padding: 12px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 10px; line-height: 1.6; overflow-wrap: break-word; word-wrap: break-word; border: 1px solid rgba(255, 255, 255, 0.1); white-space: pre-wrap; max-width: 100%; box-sizing: border-box;">
const jwt = require('jsonwebtoken');

// Login endpoint - authentication
app.post('/login', async (req, res) => {
  const { username, password } = req.body;
  const user = await User.findOne({ username });
  
  if (!user || !await bcrypt.compare(password, 
    user.passwordHash)) {
    return res.status(401)
      .json({ error: 'Invalid credentials' });
  }
  
  // Issue JWT token after authentication
  const token = jwt.sign(
    { userId: user.id, role: user.role },
    process.env.JWT_SECRET,
    { expiresIn: '1h' }
  );
  
  res.json({ token });
});
                </div>
            </div>
            <div>
                <h3>RBAC Authorization Middleware</h3>
                <div style="background: #1e1e1e; color: #d4d4d4; padding: 12px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 10px; line-height: 1.6; overflow-wrap: break-word; word-wrap: break-word; border: 1px solid rgba(255, 255, 255, 0.1); white-space: pre-wrap; max-width: 100%; box-sizing: border-box;">
// Middleware to verify token (authentication)
function authenticate(req, res, next) {
  const token = 
    req.headers.authorization?.split(' ')[1];
  if (!token) 
    return res.status(401)
      .json({ error: 'No token' });
  
  try {
    req.user = jwt.verify(token, 
      process.env.JWT_SECRET);
    next();
  } catch (err) {
    res.status(401)
      .json({ error: 'Invalid token' });
  }
}

// Middleware to check role (authorization)
function authorize(...allowedRoles) {
  return (req, res, next) => {
    if (!allowedRoles.includes(req.user.role)) {
      return res.status(403)
        .json({ error: 'Forbidden' });
    }
    next();
  };
}

// Protected route - auth + authz
app.delete('/users/:id', 
  authenticate, 
  authorize('admin'), 
  (req, res) => {
    // Only authenticated admins can delete
    // ...
  }
);
                </div>
            </div>
            <div>
                <h3>OAuth 2.0 Flow (Simplified)</h3>
                <div style="background: #1e1e1e; color: #d4d4d4; padding: 12px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 10px; line-height: 1.6; overflow-wrap: break-word; word-wrap: break-word; border: 1px solid rgba(255, 255, 255, 0.1); white-space: pre-wrap; max-width: 100%; box-sizing: border-box;">
// 1. Redirect to OAuth provider
app.get('/auth/google', (req, res) => {
  const authUrl = 
    `https://accounts.google.com/` +
    `o/oauth2/v2/auth?` +
    `client_id=${CLIENT_ID}&` +
    `redirect_uri=${REDIRECT_URI}&` +
    `response_type=code&` +
    `scope=openid email profile`;
  res.redirect(authUrl);
});

// 2. Exchange code for token
app.get('/auth/callback', 
  async (req, res) => {
    const { code } = req.query;
    const url = 
      'https://oauth2.googleapis.com/token';
    const tokenResponse = await fetch(url, {
      method: 'POST',
      body: JSON.stringify({
        code,
        client_id: CLIENT_ID,
        client_secret: CLIENT_SECRET,
        redirect_uri: REDIRECT_URI,
        grant_type: 'authorization_code'
      })
    });
    
    const { access_token } = 
      await tokenResponse.json();
    // Use access_token for authorization
  }
);
                </div>
            </div>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"/></svg>
            Common Scenarios
        </h2>

        <div class="architecture-grid">
            <div class="arch-card">
                <h3>Web Application</h3>
                <p><strong>AuthN:</strong> Login with email/password + 2FA<br>
                <strong>AuthZ:</strong> User role determines dashboard features (admin sees all, viewer sees limited)</p>
            </div>
            <div class="arch-card">
                <h3>REST API</h3>
                <p><strong>AuthN:</strong> API key or JWT in Authorization header<br>
                <strong>AuthZ:</strong> Scopes/permissions in token limit endpoint access</p>
            </div>
            <div class="arch-card">
                <h3>Microservices</h3>
                <p><strong>AuthN:</strong> mTLS or service mesh identity<br>
                <strong>AuthZ:</strong> Policy engine (OPA) checks service-to-service calls</p>
            </div>
            <div class="arch-card">
                <h3>Mobile App</h3>
                <p><strong>AuthN:</strong> OAuth 2.0 with PKCE, biometric unlock<br>
                <strong>AuthZ:</strong> Backend validates token scopes for each API request</p>
            </div>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0zm-9 3.75h.008v.008H12v-.008z"/></svg>
            Common Mistakes
        </h2>

        <div class="cons-box">
            <h3>Avoid these pitfalls:</h3>
            <ul class="features-list">
                <li><strong>Skipping authentication:</strong> Relying on client-side checks only; always validate server-side</li>
                <li><strong>Weak passwords:</strong> Not enforcing complexity, allowing common passwords (use zxcvbn, haveibeenpwned)</li>
                <li><strong>Missing authorization checks:</strong> Authenticated users accessing resources they shouldn't (IDOR vulnerabilities)</li>
                <li><strong>Using authentication for authorization:</strong> "If logged in, allow all" — need granular permissions</li>
                <li><strong>Storing passwords in plaintext:</strong> Always hash with bcrypt/Argon2, never MD5/SHA-1</li>
                <li><strong>Long-lived tokens:</strong> JWTs with no expiration; hard to revoke; use short-lived + refresh tokens</li>
                <li><strong>Not using HTTPS:</strong> Credentials sent in plaintext; always encrypt in transit</li>
                <li><strong>Hardcoded secrets:</strong> API keys, JWT secrets in code; use environment variables or vaults</li>
            </ul>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"/></svg>
            Best Practices
        </h2>

        <div class="pros-box">
            <h3>Secure AuthN & AuthZ:</h3>
            <ul class="features-list">
                <li><strong>Always separate concerns:</strong> Authenticate identity, then authorize actions</li>
                <li><strong>Use proven libraries:</strong> Passport.js, Auth0, AWS Cognito, Okta — don't roll your own crypto</li>
                <li><strong>Enforce MFA:</strong> Especially for admin accounts and sensitive operations</li>
                <li><strong>Principle of least privilege:</strong> Grant minimum permissions needed; deny by default</li>
                <li><strong>Audit logs:</strong> Track who accessed what, when; essential for compliance and forensics</li>
                <li><strong>Token rotation:</strong> Short-lived access tokens (15 min), refresh tokens with rotation</li>
                <li><strong>Rate limiting:</strong> Prevent brute-force attacks on login endpoints</li>
                <li><strong>Session management:</strong> Secure cookies (HttpOnly, Secure, SameSite), logout invalidates tokens</li>
                <li><strong>Centralize authorization logic:</strong> Avoid scattering permission checks; use middleware/policy engine</li>
            </ul>
        </div>

        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 24px; height: 24px; display: inline-block; margin-right: 8px; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6v12m-7.5 0V6m7.5 0A3.75 3.75 0 0 0 8.25 6m7.5 0h3a2.25 2.25 0 0 1 2.25 2.25v7.5A2.25 2.25 0 0 1 18.75 18h-3"/></svg>
            HTTP Status Codes
        </h2>

        <div class="architecture-grid">
            <div class="arch-card">
                <h3>401 Unauthorized</h3>
                <p><strong>Authentication failed.</strong> No valid credentials provided or token expired. User must log in again.</p>
            </div>
            <div class="arch-card">
                <h3>403 Forbidden</h3>
                <p><strong>Authorization failed.</strong> User authenticated but lacks permission. Server refuses request.</p>
            </div>
        </div>

        <div class="intro-box" style="text-align: center; margin: 60px 0 40px;">
            <p>Authentication and authorization are the foundation of application security. By verifying <strong>who users are</strong> and controlling <strong>what they can do</strong>, you protect sensitive data, enforce business rules, and maintain compliance. Always implement both layers with proven standards and libraries.</p>
        </div>
    </div>
</body>
</html>
